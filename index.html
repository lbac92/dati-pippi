<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Report Generale P.I.P.P.I.</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;600;700&display=swap" rel="stylesheet">
    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
    
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>

    <button class="menu-btn" onclick="toggleMenu()">‚ò∞</button>
    <div class="nav-overlay" id="navOverlay">
        <ul class="nav-links">
            <li><a href="index.html" onclick="toggleMenu()">Home</a></li>
            <li><a href="accoglienza.html" onclick="toggleMenu()">1. L'Accoglienza</a></li>
            <li><a href="cocostruzione.html" onclick="toggleMenu()">2. Co-Costruzione</a></li>
            <li><a href="dispositivi.html" onclick="toggleMenu()">3. I Dispositivi</a></li>
            <li><a href="strumenti.html" onclick="toggleMenu()">4. Gli Strumenti</a></li>
            <li style="margin-top: 40px;"><a href="#" onclick="toggleMenu()" style="font-size: 1rem; color: #999;">‚úï Chiudi</a></li>
        </ul>
    </div>

    <div class="background-art"></div>

    <header class="hero">
        <div class="hero-content" data-aos="fade-down">
            <h1>Il Percorso P.I.P.P.I.</h1>
            <p>Tre edizioni di crescita, intrecci e supporto alla genitorialit√†.</p>
        </div>
    </header>

    <main class="container">

        <section data-aos="fade-up">
            <h2 style="text-align: center; margin-bottom: 40px; color: #fff; text-shadow: 0 2px 4px rgba(0,0,0,0.2);">1. La Linea del Tempo</h2>
            
            <div class="timeline-wrapper">
                <div class="timeline-line"></div> 
                
                <div class="timeline-step">
                    <div class="timeline-dot"></div>
                    <div class="timeline-content glass-effect">
                        <span class="timeline-title">P.I.P.P.I. 8</span>
                        <span class="timeline-year">2019 - 2021</span>
                        <hr style="border: 0; border-top: 1px solid #ccc; margin: 10px 0;">
                        <p><strong>10</strong> Famiglie (Livello Base)</p>
                        <p><strong>2</strong> Coach</p>
                    </div>
                </div>

                <div class="timeline-step">
                    <div class="timeline-dot"></div>
                    <div class="timeline-content glass-effect">
                        <span class="timeline-title">P.I.P.P.I. 10</span>
                        <span class="timeline-year">2021 - 2023</span>
                        <hr style="border: 0; border-top: 1px solid #ccc; margin: 10px 0;">
                        <p><strong>22</strong> Famiglie (Livello Avanzato)</p>
                        <p><strong>2</strong> Coach | <strong>3</strong> Formatori</p>
                        <p style="color: #e67e22; font-weight: 600; margin-top:5px;">‚òÖ Attivazione Dispositivo Sostegno Genitorialit√†</p>
                    </div>
                </div>

                <div class="timeline-step">
                    <div class="timeline-dot"></div>
                    <div class="timeline-content glass-effect">
                        <span class="timeline-title">P.I.P.P.I. 12</span>
                        <span class="timeline-year">2023 - 2025</span>
                        <hr style="border: 0; border-top: 1px solid #ccc; margin: 10px 0;">
                        <p><strong>13</strong> Famiglie (Livello Avanzato)</p>
                        <p><strong>2</strong> Coach | <strong>3</strong> Formatori</p>
                        <p style="font-size: 0.9em; color: #666; margin-bottom: 5px;">Dispositivo Sostegno Genitorialit√†</p>
                        <p style="color: #e67e22; font-weight: 600;">‚òÖ Gruppo di Lavoro Permanente</p>
                    </div>
                </div>
            </div>
        </section>

        <div class="mini-stat-strip" data-aos="fade-up" data-aos-delay="100">
            <span class="mini-stat-label">üìâ Famiglie uscite (Drop-out):</span>
            <span class="mini-stat-value">6 su 45 (13.3%)</span>
        </div>

        <div class="section-divider"></div>

        <h2 style="text-align: center; margin-bottom: 30px; color: #2c3e50;">2. Protagonisti e Bisogni</h2>
        
        <div class="grid-2-col">
            <section class="card glass-effect" data-aos="fade-right">
                <div class="card-header">
                    <h2>Chi sono le famiglie?</h2>
                </div>
                <div class="chart-container" style="height: 250px;">
                    <canvas id="familyTypeChart"></canvas>
                </div>
            </section>

            <section class="card glass-effect" data-aos="fade-left">
                <div class="card-header">
                    <h2>Fragilit√† Principali</h2>
                </div>
                <div class="chart-container" style="height: 250px;">
                    <canvas id="fragilityChart"></canvas>
                </div>
                <button id="btnFragility" class="btn-expand" onclick="toggleFragility()" style="font-size: 0.8rem; padding: 5px 15px;">Vedi tutte ‚ñº</button>
            </section>
        </div>

        <section id="extraFragilityContainer" class="card glass-effect" style="display: none; margin-bottom: 30px;">
             <h3 style="text-align: center; font-size: 1rem; color: #666;">Altre fragilit√† rilevate</h3>
             <div class="chart-container" style="height: 300px;">
                <canvas id="fragilitySecondaryChart"></canvas>
            </div>
        </section>

        <section class="card glass-effect" data-aos="fade-up" style="margin-bottom: 40px;">
            <div class="card-header">
                <h2>Rete Territoriale Operatori</h2>
            </div>
            <div class="chart-container" style="height: 250px;">
                <canvas id="operatorsChart"></canvas>
            </div>
        </section>

        <div class="section-divider"></div>

        <h2 style="text-align: center; margin-bottom: 30px; color: #2c3e50;">3. Outcome: L'Impatto del Percorso</h2>

        <section class="card glass-effect" data-aos="fade-up">
            <div class="card-header" style="text-align: center;">
                <h2>Le Dimensioni Analizzate</h2>
                <p>Seleziona un'area per vedere quali dimensioni specifiche sono state valutate.</p>
            </div>
            
            <div class="tabs-container">
                <button class="tab-btn active" onclick="showDimension('bambino', this)">üë∂ Il Mondo del Bambino</button>
                <button class="tab-btn" onclick="showDimension('famiglia', this)">üè† La Famiglia</button>
                <button class="tab-btn" onclick="showDimension('ambiente', this)">üåç L'Ambiente</button>
            </div>

            <div id="dim-bambino" class="dimension-box show">
                <ul class="dimension-list">
                    <li>Salute e crescita</li>
                    <li>Emozioni, pensieri, comportamenti</li>
                    <li>Identit√† e autostima</li>
                    <li>Autonomia</li>
                    <li>Relazioni familiari e sociali</li>
                    <li>Apprendimento</li>
                    <li>Gioco e tempo libero</li>
                </ul>
            </div>

            <div id="dim-famiglia" class="dimension-box">
                <ul class="dimension-list">
                    <li>Cura di base, sicurezza e protezione</li>
                    <li>Calore, affetto e stabilit√† emotiva</li>
                    <li>Guida, regole e valori</li>
                    <li>Divertimento, stimoli e incoraggiamento</li>
                    <li>Autorealizzazione delle figure genitoriali</li>
                </ul>
            </div>

            <div id="dim-ambiente" class="dimension-box">
                <ul class="dimension-list">
                    <li>Relazioni e sostegno sociale</li>
                    <li>Lavoro e situazione economica</li>
                    <li>Rapporto con scuola e risorse educative</li>
                    <li>Partecipazione e inclusione sociale</li>
                    <li>Abitazione</li>
                </ul>
            </div>
        </section>

        <div class="grid-2-col" style="margin-top: 30px;">
            
            <section class="card glass-effect" data-aos="fade-right">
                <div class="card-header">
                    <h3 style="color: #c0392b;">üìâ Riduzione Fattori di Rischio</h3>
                    <p style="font-size: 0.85rem;">Punteggio medio (1-5). <br><strong>Pi√π basso √®, meglio √®.</strong></p>
                </div>
                <div class="chart-container" style="height: 300px;">
                    <canvas id="riskChart"></canvas>
                </div>
            </section>

            <section class="card glass-effect" data-aos="fade-left">
                <div class="card-header">
                    <h3 style="color: #27ae60;">üìà Aumento Fattori di Protezione</h3>
                    <p style="font-size: 0.85rem;">Punteggio medio (1-5). <br><strong>Pi√π alto √®, meglio √®.</strong></p>
                </div>
                <div class="chart-container" style="height: 300px;">
                    <canvas id="protectionChart"></canvas>
                </div>
            </section>
        </div>

        <div class="service-relation-card" data-aos="zoom-in">
            <h3 style="margin: 0 0 10px 0; color: #2ecc71;">ü§ù Qualit√† della relazione con i servizi</h3>
            <p>Grazie alla co-costruzione, la percezione della qualit√† della relazione √® migliorata notevolmente.</p>
            <div style="font-size: 1.5rem; font-weight: bold; margin-top: 10px;">
                <span style="color: #95a5a6;">3.97</span> ‚ûî <span style="color: #27ae60;">4.52</span>
            </div>
        </div>

    </main>

    <footer>
        <p>Progetto P.I.P.P.I. - Report Triennale</p>
    </footer>

    <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
    <script src="script.js"></script> 
    
    <script>
        AOS.init();
        Chart.defaults.font.family = "'Quicksand', sans-serif";
        Chart.defaults.font.size = 13;

        // --- GESTIONE TAB DIMENSIONI ---
        function showDimension(type, btn) {
            // Nascondi tutti i box
            document.querySelectorAll('.dimension-box').forEach(el => el.classList.remove('show', 'display-block'));
            document.querySelectorAll('.dimension-box').forEach(el => el.style.display = 'none');
            
            // Togli active dai bottoni
            document.querySelectorAll('.tab-btn').forEach(el => el.classList.remove('active'));

            // Mostra quello giusto
            document.getElementById('dim-' + type).style.display = 'block';
            setTimeout(() => document.getElementById('dim-' + type).classList.add('show'), 10);
            
            // Attiva bottone
            btn.classList.add('active');
        }

        // --- GESTIONE FRAGILIT√Ä (Espandi) ---
        function toggleFragility() {
            var x = document.getElementById("extraFragilityContainer");
            var btn = document.getElementById("btnFragility");
            if (x.style.display === "none") {
                x.style.display = "block";
                btn.innerHTML = "Nascondi ‚ñ≤";
            } else {
                x.style.display = "none";
                btn.innerHTML = "Vedi tutte ‚ñº";
            }
        }

        // --- GRAFICI OUTCOME (DATI REALI) ---

        // 1. FATTORI DI RISCHIO (Diminuzione = Bene)
        new Chart(document.getElementById('riskChart'), {
            type: 'bar',
            data: {
                labels: ['Bambino', 'Famiglia', 'Ambiente'],
                datasets: [
                    {
                        label: 'Pre (Inizio)',
                        data: [3.23, 3.80, 3.17],
                        backgroundColor: 'rgba(231, 76, 60, 0.4)', // Rosso Chiaro
                        borderColor: '#c0392b',
                        borderWidth: 1
                    },
                    {
                        label: 'Post (Fine)',
                        data: [2.73, 2.79, 2.67],
                        backgroundColor: '#c0392b', // Rosso Scuro (Risultato)
                        borderColor: '#922b21',
                        borderWidth: 1
                    }
                ]
            },
            options: {
                scales: {
                    y: { beginAtZero: false, min: 1, max: 5, title: {display: true, text: 'Scala 1-5'} }
                },
                plugins: { legend: { position: 'bottom' } }
            }
        });

        // 2. FATTORI DI PROTEZIONE (Aumento = Bene)
        new Chart(document.getElementById('protectionChart'), {
            type: 'bar',
            data: {
                labels: ['Bambino', 'Famiglia', 'Ambiente'],
                datasets: [
                    {
                        label: 'Pre (Inizio)',
                        data: [2.97, 2.91, 3.11],
                        backgroundColor: 'rgba(46, 204, 113, 0.4)', // Verde Chiaro
                        borderColor: '#27ae60',
                        borderWidth: 1
                    },
                    {
                        label: 'Post (Fine)',
                        data: [3.94, 3.58, 3.88],
                        backgroundColor: '#27ae60', // Verde Scuro (Risultato)
                        borderColor: '#1e8449',
                        borderWidth: 1
                    }
                ]
            },
            options: {
                scales: {
                    y: { beginAtZero: false, min: 1, max: 5, title: {display: true, text: 'Scala 1-5'} }
                },
                plugins: { legend: { position: 'bottom' } }
            }
        });

        // --- ALTRI GRAFICI (Fragilit√† ecc.) ---

        new Chart(document.getElementById('fragilityChart'), {
            type: 'bar',
            data: {
                labels: ['Economica', 'Eventi Traumatici', 'Abitativa', 'Assenza Genitori', 'Disagio Psic. Bambino', 'Isolamento'],
                datasets: [{
                    data: [51, 46, 42, 40, 40, 37],
                    backgroundColor: '#e74c3c',
                    borderRadius: 4
                }]
            },
            options: { maintainAspectRatio: false, plugins: { legend: { display: false } } }
        });

        new Chart(document.getElementById('fragilitySecondaryChart'), {
            type: 'bar',
            data: {
                labels: ['Disagio Psic. Famiglia', 'Bassa Scolar.', 'Migrazione', 'Incuria', 'Disabilit√†', 'Conflitti', 'Maltrattamento', 'Transgen.', 'Altro'],
                datasets: [{
                    data: [34, 31, 23, 20, 20, 20, 11, 11, 9],
                    backgroundColor: '#3498db',
                    borderRadius: 4
                }]
            },
            options: { indexAxis: 'y', maintainAspectRatio: false, plugins: { legend: { display: false } } }
        });
        
        // Placeholder Famiglie e Operatori (da riempire coi dati reali quando li hai)
        new Chart(document.getElementById('familyTypeChart'), {
            type: 'doughnut',
            data: { labels: ['Tipo A', 'Tipo B'], datasets: [{ data: [50, 50], backgroundColor: ['#ddd', '#eee'] }] },
            options: { maintainAspectRatio: false }
        });
        new Chart(document.getElementById('operatorsChart'), {
            type: 'bar',
            data: { labels: ['Ente A', 'Ente B'], datasets: [{ data: [10, 5], backgroundColor: '#34495e' }] },
            options: { indexAxis: 'y', maintainAspectRatio: false }
        });

    </script>

</body>
</html>